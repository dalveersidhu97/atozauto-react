var q=Object.defineProperty;var N=(o,e,t)=>e in o?q(o,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[e]=t;var M=(o,e,t)=>(N(o,typeof e!="symbol"?e+"":e,t),t);import{S as x,d as y,a as j}from"./comparison.utils.08c82949.js";const g=class{constructor(){}static add(e,t=0,n=g.NEXT_DELAY){const s={injectorFn:e,delay:t,delayNext:n};g.injectors.push(s),g.next()}static next(){let e=g.busyTill-Date.now();for(e<0&&(e=0);g.injectors.length>0;){const t=g.injectors.shift();if(t){const{injectorFn:n,delay:s,delayNext:r}=t;e+=s,setTimeout(()=>{n()},e),e+=r}}g.busyTill=Date.now()+e}};let h=g;M(h,"NEXT_DELAY",500),M(h,"injectors",[]),M(h,"busyTill",Date.now());const Y=o=>{const e=new Date;e.setMilliseconds(e.getMilliseconds()+o),B(e)},B=o=>{const e=new Date;let n=(o.getTime()-e.getTime())/1e3;n<0&&(n=0);const s=o.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",second:"2-digit",hour12:!0});w(s,Math.round(n)),setInterval(()=>{let r=(o.getTime()-new Date().getTime())/1e3;r<0&&(r=0),w(s,Math.round(r))},1e3)},I=()=>{var o;(o=document.getElementById("azauto-info-box"))==null||o.remove()},v=(o,e)=>{const t=document.createElement("div");t.classList.add("azauto-info-box-container"),t.innerHTML=o,H("",n=>{n.children.length?n.insertBefore(t,n.children[0]):n.appendChild(t)}),!e&&setTimeout(()=>{t.classList.add("fade-out"),setTimeout(()=>{t.remove()},1500)},1500)},w=(o,e)=>{const t=e%60,n=(e-t)/60,s=e<=60?`${e}s`:`${n}m ${t%60}s`,r=document.getElementById("azauto-timer-text");if(r){r.innerText=s;return}v(`
        <div id="azauto-info-title">Reloading...</div>
        <div>${o}</div>
        <div id="azauto-timer-text">${s}</div>
    `,!0)},H=(o,e)=>{const t="azauto-info-box";let n=document.getElementById(t);const s="20rem",r=".5rem";if(n){o&&(n.innerHTML=o),e&&e(n);return}const a=(l,i)=>(n=document.createElement("div"),n.style.top=l,n.style.left=i,n.id=t,n.classList.add("azauto-info-box"),document.body.appendChild(n),o&&(n.innerHTML=o),n);chrome.storage.local.get(x.infoBoxPos,l=>{const i=l[x.infoBoxPos]||{top:s,lef:r};let c;const m=T=>{c&&clearTimeout(c),c=setTimeout(()=>{chrome.storage.local.set({[x.infoBoxPos]:{top:T.top+"px",left:T.left+"px"}})},100)},f=a(i.top,i.left),{onMouseDown:u,onMouseMove:d,onMouseUp:p}=J(t,m);f.onmousedown=u,document.onmousemove=d,document.onmouseup=p,f.addEventListener("touchstart",u,{passive:!1}),f.addEventListener("touchmove",d,{passive:!1}),f.addEventListener("touchend",p,{passive:!1}),e&&e(f)})},J=(o,e)=>{let t,n,s=!1;function r(i){const c=document.getElementById(o);!c||(i.preventDefault(),s=!0,i instanceof MouseEvent?(t=i.clientX-c.getBoundingClientRect().left,n=i.clientY-c.getBoundingClientRect().top):i instanceof TouchEvent&&i.touches.length===1&&(t=i.touches[0].clientX-c.getBoundingClientRect().left,n=i.touches[0].clientY-c.getBoundingClientRect().top))}function a(i){const c=document.getElementById(o);if(!c)return;i.preventDefault();const m=window.innerHeight-c.offsetHeight,f=window.innerWidth-c.offsetWidth;if(s){let u,d;i instanceof MouseEvent?(u=i.clientX-t,d=i.clientY-n):i instanceof TouchEvent&&i.touches.length===1?(u=i.touches[0].clientX-t,d=i.touches[0].clientY-n):(u=0,d=0),u>f&&(u=f),u<0&&(u=0),d>m&&(d=m),d<0&&(d=0),c.style.top=`${d}px`,c.style.left=`${u}px`,e({top:d,left:u})}}function l(i){i.preventDefault(),s=!1}return{onMouseDown:r,onMouseMove:a,onMouseUp:l}};function S(o,e,t){var n=o.querySelectorAll(e);for(let s=0;s<n.length;s++){const r=n[s];if(RegExp(t).test(r.textContent||""))return r}}const $=o=>{document.querySelectorAll('div[role="dialog"]').forEach(t=>{if(!t)console.log("No modal");else{const n=S(t,'button[data-test-component="ModalCloseButton"]',"");n?(n.click(),o&&o()):console.log("No button")}})},F=(o,e)=>{const t=document.querySelector('div[data-test-component="StencilModal"]');if(!t)return console.log("No modal"),!1;const n=S(t,"button",o);return n?(n.click(),e&&e(),!0):(console.log("No button",o),!1)},O=(o,e)=>{const t=document.querySelectorAll('div[role="dialog"]');let n=!1;return t.forEach(s=>{if(!s)console.log("No modal");else{const r=S(s,"button",o);r?(r.click(),e&&e(),n=!0):console.log("No button",o)}}),n},C=()=>{var n,s;if(typeof document=="undefined")return{name:""};const o=document.querySelector("#navbar-menu");if(!o)return{};const e=o.querySelector(`img[alt="User's avatar"]`),t=(s=(n=e==null?void 0:e.parentElement)==null?void 0:n.parentElement)==null?void 0:s.innerText;return{name:t==null?void 0:t.trim(),img:e==null?void 0:e.getAttribute("src")}},k=()=>{const o=C();chrome.storage.local.set({[x.userInfo]:o})};function D(o){const e=o.replace(/\D/g,"");return parseInt(e,10)}const L=o=>{if(!o||!o.trim())return;const e=o.trim().toLowerCase(),t=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],n=["January","February","March","April","May","June","July","August","September","October","November","December"],s=[...t,...n],r=e.split(",");for(let a=0;a<r.length;a++){const l=r[a].trim(),i=s.find(c=>l.includes(c.toLowerCase()));if(i){const c=l.split(" ");if(c.length===2){const m=D(c[1])||D(c[0]),f=n.findIndex(u=>u===i);return f!==-1?{month:t[f],day:m}:{month:i,day:m}}}}},z=(o,e)=>{const t=L(o),n=L(e);return!t||!n?!1:t.day===n.day&&t.month===n.month},E=(o,e,t)=>{let n=!1;switch(e){case"gt":{o>t&&(n=!0);break}case"gte":{o>=t&&(n=!0);break}case"lt":{o<t&&(n=!0);break}case"lte":{o<=t&&(n=!0);break}case"eq":{o===t&&(n=!0);break}}return n&&console.log(o,e,t,n),n},A=(o,e)=>(e<=o&&(e=e+24*60),e-o),R=(o,e,t)=>{const n=C().name||"",s=o.date,r=t.date;if(t.forName.toLowerCase().trim()!==n.toLowerCase().trim())return console.log("User name does not match"),!1;if(!z(s,r))return!1;for(let a=0;a<t.timeRules.length;a++){const l=t.timeRules[a];let i=!0;if(l.type==="Start Time"?i=E(o.startTime,l.op,l.minutes):l.type==="End Time"?i=E(o.endTime,l.op,l.minutes):l.type==="Duration"&&(i=E(e,l.op,l.minutes)),!i)return!1}return!0},V=(o,e)=>{for(let t=0;t<o.length;t++)if(R(e,A(e.startTime,e.endTime),o[t]))return o[t];return!1},W=(o,e)=>{if(!e.length)return!1;let t=0;e.forEach(n=>{t+=A(n.startTime,n.endTime)});for(let n=0;n<o.length;n++)if(R({date:e[0].date,endTime:e[e.length-1].endTime,startTime:e[0].startTime},t,o[n]))return o[n];return!1},b=(o,e)=>e.map(n=>JSON.stringify(n)).indexOf(JSON.stringify(o)),G=(o,e)=>{function t(n,s){return b(n.filter,e)<b(s.filter,e)?-1:b(n.filter,e)>b(s.filter,e)?1:0}return o.sort(t)},P=(o,e,t,n,s,r,a)=>{console.log(n,": Entering",(a||0)+1,"/",o.length);let l=a||0,i=s||0,c=r||0;o.length>l?setTimeout(()=>{e(o[l],()=>{o.length-1>l?P(o,e,t,n,i,r,l+1):(t(),n&&console.log(n,": Done"))},l)},(l===0?0:i)+(l===0?c:0)):(t(),n&&console.log(n,": End"))},Z=(o,e)=>{chrome.storage.local.get(o,function(t){const s=(t[o]||[]).filter(r=>!j(e,r));chrome.storage.local.set({[o]:s})})},K=(o,e)=>{const t=new Date,n=new Date,s=e.refreshMode;if(!o.length||s==="Off")return h.add(I);if(s==="Full Speed")return h.add(I),window.location.reload();const r=n.getMinutes(),a=n.getSeconds(),l=e.hotMinutesMultiplier||y.hotMinutesMultiplier,i=e.hotSecondsLessThan||y.hotSecondsLessThan,c=e.minutesIncrementBy||y.minutesIncrementBy,m=e.secondsIncrementBy||y.secondsIncrementBy,f=r+l-r%l,u=()=>{r+c<=f?t.setMinutes(r+c):t.setMinutes(f),t.setSeconds(0),t.setMilliseconds(0)};if(r%l===0)if(a<i){const T=i<a+m?i:a+m;t.setSeconds(T)}else u();else u();t.setMilliseconds(t.getMilliseconds()+50);let d=t.getTime()-n.getTime();d<0&&(d=0),setTimeout(()=>window.location.reload(),d);const p=()=>B(t);h.add(p)};export{h as I,G as a,v as b,$ as c,O as d,Z as e,K as f,C as g,H as h,V as i,Y as j,z as k,P as l,W as m,F as p,I as r,k as s};
